!function(i){"use strict";i.ToggleMenuOverlay=function(e,t){return this.toggleMenu=e,i.extend(!0,this.settings={},this.toggleMenu.settings,i.ToggleMenuOverlay.defaults,t),this.elements=this.settings.elements,delete this.settings.elements,this.events={},!!this.prepareOptions()&&this.load()},i.ToggleMenuOverlay.defaults={elements:{content:{menu:void 0},items:void 0,itemLink:function(e){return e.children("a")},toggle:void 0},closeOnEscape:!0,classes:{open:"is-{prefix}Open",active:"is-active",copy:"{prefix}-copy"},onLoad:void 0,beforeWrap:void 0,onAddContent:void 0,afterEventsHandler:void 0,afterItemHandler:void 0,onComplete:void 0,onToggle:void 0,onToggleSubmenu:void 0},i.ToggleMenuOverlay.prototype={prepareOptions:function(){return this.toggleMenu.replacePrefixClass.call(this),void 0===this.elements.toggle&&(this.elements.toggle=i("."+this.settings.classes.prefix+"-toggle"),0===this.elements.toggle.length)?(this.toggleMenu.setLog("error","Missing elements.toggle parameter"),!1):void 0!==this.elements.content.menu||(this.toggleMenu.setLog("error","Missing elements.content.menu parameter"),!1)},load:function(){return void 0!==this.settings.onLoad&&this.settings.onLoad.call({toggleMenuOverlay:this}),this.wrap(),this.addContent(),this.eventsHandler(),this.itemsHandler(),void 0!==this.settings.onComplete&&this.settings.onComplete.call({toggleMenuOverlay:this,elements:this.elements}),this},wrap:function(){return this.elements.wrapper=i("<nav>",{class:"nav nav--"+this.settings.classes.prefix+"Overlay"}),void 0!==this.settings.beforeWrap&&this.settings.beforeWrap.call({toggleMenuOverlay:this,wrapper:this.elements.wrapper}),this.elements.wrapper.appendTo(this.toggleMenu.elements.body),this},unWrap:function(){return this.elements.wrapper.remove(),this},addContent:function(){var s=this;return i.each(s.elements.content,function(e,t){var n=null;"object"==typeof t&&t.length&&((n=t.clone()).removeAttr("id"),t.addClass(s.settings.classes.copy)),null!=n&&(n.appendTo(s.elements.wrapper),n.wrap(i("<div>",{class:s.settings.classes.prefix+"-"+e})),"menu"===e&&(s.elements[e+"Content"]=n,s.elements[e]=n.parent(),void 0===s.elements.items?s.elements.items=s.toggleMenu.getItemsParent(n.find("li")):"function"==typeof s.elements.items&&(s.elements.items=s.elements.items(n)))),void 0!==s.settings.onAddContent&&s.settings.onAddContent.call({toggleMenuOverlay:s,type:e,element:t,content:n,contentWrapper:s.elements[e]})}),s},eventsHandler:function(){var e=this;return e.elements.toggle.on(e.events.toggle="click.togglemenu.toggle",function(){e.toggle()}),void 0!==e.settings.afterEventsHandler&&e.settings.afterEventsHandler.call({toggleMenuOverlay:e,elements:e.elements,events:e.events}),e},itemsHandler:function(){var n=this;return n.elements.items.length&&n.elements.items.each(function(e,t){t=i(t),null!==n.elements.itemLink&&n.elements.itemLink(t).on("click.togglemenu.itemLink",function(e){e.preventDefault(),n.isOpen||n.toggle(),n.toggleSubmenu(t)}),void 0!==n.settings.afterItemHandler&&n.settings.afterItemHandler.call({toggleMenuOverlay:n,elements:n.elements,item:t})}),n},toggle:function(){var t=this;return t.toggleMenu.elements.body.toggleClass(t.settings.classes.open),t.isOpen=t.toggleMenu.elements.body.hasClass(t.settings.classes.open),t.isOpen||(t.closeSubmenus(),i(document).off("keydown.togglemenuOverlay")),t.settings.closeOnEscape&&t.isOpen&&i(document).one("keydown.togglemenuOverlay",function(e){27===e.keyCode&&t.toggle()}),void 0!==t.settings.onToggle&&t.settings.onToggle.call({toggleMenuOverlay:t,body:t.toggleMenu.elements.body,isOpen:t.isOpen}),t},toggleSubmenu:function(e){return this.closeSubmenus(e),e.toggleClass(this.settings.classes.active),void 0!==this.settings.onToggleSubmenu&&this.settings.onToggleSubmenu.call({toggleMenuOverlay:this,item:e}),this},closeSubmenus:function(e){var t=void 0!==e?e.siblings("."+this.settings.classes.active):this.elements.items,n=t.find("."+this.settings.classes.active);if(t.length&&t.removeClass(this.settings.classes.active),n.length&&n.removeClass(this.settings.classes.active),void 0!==e){var s=e.find("."+this.settings.classes.active);s.length&&s.removeClass(this.settings.classes.active)}return this},unload:function(){var n=this;return n.isOpen&&n.toggle(),n.unWrap(),i.each(n.events,function(e,t){n.elements[e].off(t)}),null!==n.elements.itemLink&&n.elements.items.each(function(e,t){n.elements.itemLink(i(t)).off("click.togglemenu.itemLink")}),i(document).off("keydown.togglemenuOverlay"),i.each(n.elements.content,function(e,t){t.removeClass(n.settings.classes.copy)}),n}}}(jQuery);