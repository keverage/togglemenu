!function(o){"use strict";o.ToggleMenuHover=function(e,t){return this.toggleMenu=e,o.extend(o.ToggleMenuHover.prototype,o.ToggleMenu.prototype),o.extend(!0,this.settings={},this.toggleMenu.settings,o.ToggleMenuHover.defaults,t),this.elements=this.settings.elements,delete this.settings.elements,this.position={previous:{x:0,y:0},current:{x:0,y:0}},this.events={},this.prepareUserOptions()&&this.load(),this},o.ToggleMenuHover.defaults={elements:{menu:void 0,items:void 0,itemLink:"> a"},classes:{active:"is-active"},disableItemsClick:!1,interval:100,timeout:200,beforeLoad:void 0,afterEventsHandler:void 0,onComplete:void 0,onOver:void 0,onOut:void 0},o.ToggleMenuHover.prototype={prepareUserOptions:function(){return void 0===this.getElements().menu?(this.setLog("Missing elements.menu parameter","error"),!1):(void 0===this.getElements().items&&(this.elements.items=this.getItemsParent(this.getElements().menu.find("li"))),0!==this.getElements().items.length)},load:function(){return void 0!==this.settings.beforeLoad&&this.settings.beforeLoad.call({toggleMenuHover:this}),this.eventsHandler(),void 0!==this.settings.onComplete&&this.settings.onComplete.call({toggleMenuHover:this,elements:this.getElements()}),this},unload:function(){var i=this;return o.each(i.events,function(e,t){i.getElements()[e].off(t)}),i},eventsHandler:function(){var i=this;return i.getElements().items.on(i.events.items="focusin.togglemenu focusout.togglemenu blur.togglemenu mouseenter.togglemenu mouseleave.togglemenu",function(e){var t={event:o.extend({},e),item:this,$item:o(e.currentTarget)};t.item.hoverTimeout&&(t.item.hoverTimeout=clearTimeout(t.item.hoverTimeout)),"mouseenter"===t.event.type||"focusin"===t.event.type?(i.setPosition("previous",t.event),t.$item.on("mousemove.togglemenu",function(){i.setPosition("current",t.event)}),!0!==t.item.hoverState&&(t.item.hoverTimeout=setTimeout(function(){i.comparePosition(t)},i.settings.interval))):(t.$item.off("mousemove.togglemenu"),!0===t.item.hoverState&&(t.item.hoverTimeout=setTimeout(function(){return t.item.hoverTimeout=clearTimeout(t.item.hoverTimeout),t.item.hoverState=!1,i.onOut.call(o.extend({toggleMenuHover:i},t))},i.settings.timeout)))}),i.settings.disableItemsClick&&i.getElements().items.on(i.events.itemsLink="click.togglemenu",i.getElements().itemLink,function(e){e.preventDefault()}),void 0!==i.settings.afterEventsHandler&&i.settings.afterEventsHandler.call({toggleMenuHover:i,elements:i.getElements(),events:i.events}),i},setPosition:function(e,t){return this.position[e].x=t.pageX,this.position[e].y=t.pageY,this},getPosition:function(e,t){var i=this.position[e];return void 0!==t&&(i=i[t]),i},comparePosition:function(e){var t=this;return e.item.hoverTimeout=clearTimeout(e.item.hoverTimeout),Math.abs(t.getPosition("previous","x")-t.getPosition("current","x"))+Math.abs(t.getPosition("previous","y")-t.getPosition("current","y"))<7?(e.$item.off("mousemove.togglemenu"),e.item.hoverState=!0,t.onOver.call(o.extend({toggleMenuHover:t},e))):(t.position.previous.x=t.getPosition("current","x"),t.position.previous.y=t.getPosition("current","y"),e.item.hoverTimeout=setTimeout(function(){t.comparePosition(e)},t.settings.interval),t)},onOver:function(){return this.$item.addClass(this.toggleMenuHover.settings.classes.active),void 0!==this.toggleMenuHover.settings.onOver&&this.toggleMenuHover.settings.onOver.call(this),this},onOut:function(){return this.$item.removeClass(this.toggleMenuHover.settings.classes.active),void 0!==this.toggleMenuHover.settings.onOut&&this.toggleMenuHover.settings.onOut.call(this),this}}}(jQuery);