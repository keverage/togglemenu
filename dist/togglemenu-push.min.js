!function(i){"use strict";i.ToggleMenuPush=function(e,t){return this.toggleMenu=e,i.extend(i.ToggleMenuPush.prototype,i.ToggleMenu.prototype),i.extend(!0,this.settings={},this.toggleMenu.settings,i.ToggleMenuPush.defaults,t),this.elements=i.extend(!0,{body:i("body")},this.settings.elements),delete this.settings.elements,this.events={},this.isOpen=!1,this.prepareUserOptions()&&this.load(),this},i.ToggleMenuPush.defaults={elements:{content:{menu:void 0},items:void 0,itemLink:function(e){return e.children("a")},itemContent:function(e){return e.children("ul")},toggle:void 0,page:void 0,back:void 0,backBtn:function(e){return e.children("button")}},layout:"accordion",backLink:!1,classes:{submenuOpen:"is-{prefix}-submenu-open",copy:"{prefix}-copy",back:"item-back"},beforeLoad:void 0,beforeWrap:void 0,onAddContent:void 0,afterEventsHandler:void 0,afterItemHandler:void 0,onAddItemContent:void 0,onComplete:void 0,onToggle:void 0,onToggleSubmenu:void 0},i.ToggleMenuPush.prototype={prepareUserOptions:function(){return this.replacePrefixClass(),void 0===this.getElements().toggle&&(this.elements.toggle=i("."+this.settings.classes.prefix+"-toggle"),0===this.getElements().toggle.length)?(this.setLog("Missing elements.toggle parameter","error"),!1):void 0===this.getContentElements().menu?(this.setLog("Missing elements.content.menu parameter","error"),!1):void 0!==this.getElements().page||(this.elements.page=this.getElements().body.children("div:first"),0!==this.getElements().page.length)||(this.setLog("Missing elements.page parameter","error"),!1)},load:function(){return void 0!==this.settings.beforeLoad&&this.settings.beforeLoad.call({toggleMenuPush:this}),this.wrap(),this.addContent(),this.eventsHandler(),this.itemsHandler(),void 0!==this.settings.onComplete&&this.settings.onComplete.call({toggleMenuPush:this,elements:this.getElements()}),this},unload:function(){var s=this;return s.isOpen&&s.toggle(),s.unWrap(),i.each(s.events,function(e,t){void 0!==s.getElements()[e]&&s.getElements()[e].off(t)}),s.getElements().items.each(function(e,t){t=i(t),s.getElements().itemLink(t).off("click.togglemenuPush"),void 0!==s.getElements().back&&s.getElements().backBtn(t).off("click.togglemenuPush")}),i.each(s.getContentElements(),function(e,t){"close"!==e&&t.removeClass(s.settings.classes.copy)}),s},wrap:function(){return this.elements.wrapper=i("<nav>",{class:this.settings.classes.prefix+" "+this.settings.classes.prefix+"--"+this.toggleMenu.menu.current}),void 0!==this.settings.beforeWrap&&this.settings.beforeWrap.call({toggleMenuPush:this,wrapper:this.getWrapper()}),this.getWrapper().appendTo(this.getElements().body),this},unWrap:function(){return this.getWrapper().remove(),this},addContent:function(){var n=this;return i.each(n.getContentElements(),function(e,t){var s=null;"close"===e?s=i("<button>",{html:t}):"object"==typeof t&&t.length&&((s=t.clone()).removeAttr("id"),t.addClass(n.settings.classes.copy)),null!=s&&(s.appendTo(n.getWrapper()),s.wrap(i("<div>",{class:n.settings.classes.prefix+"-"+e})),"close"!==e&&"menu"!==e||(n.elements[e+"Content"]=s,n.elements[e]=s.parent()),"menu"===e&&(void 0===n.getElements().items?n.elements.items=n.getItemsParent(s.find("li")):"function"==typeof n.getElements().items&&(n.elements.items=n.getElements().items(s)))),void 0!==n.settings.onAddContent&&n.settings.onAddContent.call({toggleMenuPush:n,type:e,element:t,content:s,contentWrapper:n.getElements()[e]})}),n},eventsHandler:function(){var e=this;return e.getElements().toggle.on(e.events.toggle="click.togglemenuPush",{self:e},e.toggle),void 0!==e.getElements().closeContent&&e.getElements().closeContent.on(e.events.closeContent="click.togglemenuPush",{self:e},e.toggle),void 0!==e.settings.afterEventsHandler&&e.settings.afterEventsHandler.call({toggleMenuPush:e,elements:e.getElements(),events:e.events}),e},itemsHandler:function(){var s=this;return s.getElements().items.length&&s.getElements().items.each(function(e,t){(t=i(t)).layout=s.getItemLayout(t),t.addClass("l-"+t.layout),s.addItemContent(t),s.getElements().itemLink(t).on("click.togglemenuPush",function(e){e.preventDefault(),s.toggleSubmenu(t)}),void 0!==s.settings.afterItemHandler&&s.settings.afterItemHandler.call({toggleMenuPush:s,elements:s.getElements(),item:t})}),s},getItemLayout:function(e){if("data"===this.settings.layout&&void 0!==e){var t=e.attr("data-layout");return void 0!==t||""!==t?t:i.ToggleMenuPush.defaults.layout}return this.settings.layout},addItemContent:function(e){var t=this;if("panel"===e.layout){var s=null;if(void 0!==t.getElements().back)s=t.getElements().back;else{s=i("<li>",{class:t.settings.classes.back}),i("<button>",{class:"item-btn"}).appendTo(s);var n=i("<span>",{class:"item-title",html:t.getElements().itemLink(e).text()}).appendTo(s);t.settings.backLink&&n.wrapInner(i("<a>",{href:t.getElements().itemLink(e).attr("href")}))}null!==s&&(s.prependTo(t.getElements().itemContent(e)),t.getElements().backBtn(s).on("click.togglemenuPush",function(){t.toggleSubmenu(e)}),void 0!==t.settings.onAddItemContent&&t.settings.onAddItemContent.call({toggleMenuPush:t,item:e,itemContent:s}))}return t},toggle:function(e){var t=void 0!==e&&void 0!==e.data&&void 0!==e.data.self?e.data.self:this;return t.getElements().body.toggleClass(t.settings.classes.open),t.isOpen=t.getElements().body.hasClass(t.settings.classes.open),t.onReady(function(){t.isOpen?t.getElements().page.on(t.events.page="click.togglemenuPush touchstart.togglemenuPush",function(e){e.preventDefault(),t.isOpen&&t.toggle()}):(t.getElements().page.off(t.events.page),t.closeSubmenus())}),void 0!==t.settings.onToggle&&t.settings.onToggle.call({toggleMenuPush:t,elements:t.getElements(),isOpen:t.isOpen}),t},toggleSubmenu:function(e){return this.closeSubmenus(e),e.toggleClass(this.settings.classes.active),void 0!==e.layout&&"panel"===e.layout&&(this.getWrapper().scrollTop(0),this.getElements().body.toggleClass(this.settings.classes.submenuOpen)),void 0!==this.settings.onToggleSubmenu&&this.settings.onToggleSubmenu.call({toggleMenuPush:this,item:e}),this},closeSubmenus:function(e){var t=void 0!==e?e.siblings("."+this.settings.classes.active):this.getElements().items,s=t.find("."+this.settings.classes.active);if(t.length&&(t.removeClass(this.settings.classes.active),this.getElements().body.hasClass(this.settings.classes.submenuOpen)&&this.getElements().body.removeClass(this.settings.classes.submenuOpen)),s.length&&s.removeClass(this.settings.classes.active),void 0!==e){var n=e.find("."+this.settings.classes.active);n.length&&n.removeClass(this.settings.classes.active)}return this}}}(jQuery);