!function(e){"use strict";e.ToggleMenuMega=function(t,s){this.ToggleMenu=t,e.extend(!0,this.settings={},this.ToggleMenu.settings,e.ToggleMenuMega.defaults,s),this.elements=this.settings.elements,delete this.settings.elements,this.events={},this.prepareOptions()&&this.load()},e.ToggleMenuMega.defaults={elements:{menu:void 0,items:void 0,itemLink:function(e){return e.children("a")},close:void 0},overlay:!0,classes:{open:"is-{prefix}Open",active:"is-active"},onLoad:void 0,beforeAddOverlay:void 0,afterEventsHandler:void 0,afterItemHandler:void 0,onComplete:void 0,onToggleSubmenu:void 0},e.ToggleMenuMega.prototype={prepareOptions:function(){return this.ToggleMenu.replacePrefixClass.call(this),void 0===this.elements.menu?(this.ToggleMenu.setLog("error",'Missing element "elements.menu" in options.'),!1):void 0!==this.elements.items||(this.ToggleMenu.setLog("error",'Missing element "elements.items" in options.'),!1)},load:function(){void 0!==this.settings.onLoad&&this.settings.onLoad.call({ToggleMenuMega:this}),this.settings.overlay&&this.addOverlay(),this.eventsHandler(),this.itemsHandler(),void 0!==this.settings.onComplete&&this.settings.onComplete.call({ToggleMenuMega:this,elements:this.elements})},addOverlay:function(){this.elements.overlay=e("<div>",{class:this.settings.classes.prefix+"Mega-overlay"}),void 0!==this.settings.beforeAddOverlay&&this.settings.beforeAddOverlay.call({ToggleMenuMega:this,overlay:this.elements.overlay}),this.elements.overlay.appendTo(this.ToggleMenu.elements.body)},removeOverlay:function(){this.elements.overlay.remove()},eventsHandler:function(){var e=this;void 0!==e.elements.close&&e.elements.close.on(e.events.close="click.togglemenu.close",function(){e.toggleSubmenu()}),e.settings.overlay&&e.elements.overlay.on(e.events.overlay="click.togglemenu.overlay",function(){e.toggleSubmenu()}),void 0!==e.settings.afterEventsHandler&&e.settings.afterEventsHandler.call({ToggleMenuMega:e,elements:e.elements,events:e.events})},itemsHandler:function(){var t=this;t.elements.items.length&&t.elements.items.each(function(){var s=e(this);t.elements.itemLink(s).on("click.togglemenu.itemLink",function(e){e.preventDefault(),t.toggleSubmenu(s)}),void 0!==t.settings.afterItemHandler&&t.settings.afterItemHandler.call({ToggleMenuMega:t,elements:t.elements,item:s})})},toggleSubmenu:function(e){this.closeSubmenus(e),void 0!==e&&(e.toggleClass(this.settings.classes.active),this.settings.overlay&&this.ToggleMenu.elements.body.toggleClass(this.settings.classes.open)),void 0!==this.settings.onToggleSubmenu&&this.settings.onToggleSubmenu.call({ToggleMenuMega:this,item:e})},closeSubmenus:function(e){var t=void 0!==e?e.siblings("."+this.settings.classes.active):this.elements.items,s=t.find("."+this.settings.classes.active);if(t.length&&(t.removeClass(this.settings.classes.active),this.settings.overlay&&this.ToggleMenu.elements.body.removeClass(this.settings.classes.open)),s.length&&s.removeClass(this.settings.classes.active),void 0!==e){var n=e.find("."+this.settings.classes.active);n.length&&n.removeClass(this.settings.classes.active)}},unload:function(){var t=this;t.settings.overlay&&t.removeOverlay(),e.each(t.events,function(e,s){t.elements[e].off(s)}),t.elements.items.each(function(){t.elements.itemLink(e(this)).off("click.togglemenu.itemLink")})}}}(jQuery);